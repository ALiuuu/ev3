package com.aliu.ev3.ev3.main;import android.content.ContentValues;import android.content.Intent;import android.net.Uri;import android.os.Bundle;import android.os.Environment;import android.provider.MediaStore;import android.text.TextUtils;import android.util.Log;import android.view.View;import android.widget.TextView;import com.aliu.ev3.R;import com.aliu.ev3.ev3.CoreApplication;import com.aliu.ev3.ev3.InDialog;import java.io.File;import androidx.appcompat.app.ActionBar;import androidx.appcompat.app.AppCompatActivity;import androidx.recyclerview.widget.GridLayoutManager;import androidx.recyclerview.widget.RecyclerView;public class PutActivity extends AppCompatActivity {    public static final int    CLOTHES_CODE = 1;    public static final int    PANTS_CODE   = 2;    public static final int    SHOES_CODE   = 3;    public static final String REQUEST_CODE = "REQUEST_CODE";    public static final int    RESULT_CANCEL = 4;    public static final int    RESULT_CHOSE  = 5;    public static final int    RESULT_CAMAER = 6;    public static final String RESULT_CODE   = "RESULT_CODE";    private RecyclerView rv;    public static final int[] clothes = new int[]{            R.drawable.clothes1,            R.drawable.clothes2,            R.drawable.clothes3,            R.drawable.clothes4,            R.drawable.clothes5,            R.drawable.clothes6,            R.drawable.clothes7,            R.drawable.clothes8,            R.drawable.clothes9,            R.drawable.clothes10,            R.drawable.clothes11,            R.drawable.clothes12,            R.drawable.clothes13,            R.drawable.clothes14    };    public static final int[] pants = new int[]{            R.drawable.pants1,            R.drawable.pants2,            R.drawable.pants3,            R.drawable.pants4,            R.drawable.pants5,            R.drawable.pants6,            R.drawable.pants7,            R.drawable.pants8,    };    public static final int[] shoes = new int[]{            R.drawable.shoes1,            R.drawable.shoes2,            R.drawable.shoes3,            R.drawable.shoes4,            R.drawable.shoes5    };    private RvAdapter rvAdapter;    private InDialog  inDialog;    private TextView  mTvOpenCamera;    @Override    public void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        // 隐藏系统标题栏        ActionBar actionBar = getSupportActionBar();        if (actionBar != null)            actionBar.hide();        if (CoreApplication.isPad) {            setContentView(R.layout.layout_put_pad);        } else {            setContentView(R.layout.layout_put);        }        setResult(RESULT_CANCEL);        TextView tvTittle = findViewById(R.id.tv_tittle);        mTvOpenCamera = findViewById(R.id.tv_opencamera);        mTvOpenCamera.setOnClickListener(v -> {            openCamera();        });        Intent intent = getIntent();        int intExtra = intent.getIntExtra(REQUEST_CODE, 0);        int[] res = new int[]{};        switch (intExtra) {            case 0:                finish();                break;            case CLOTHES_CODE:                tvTittle.setText("选择衣服");                res = clothes;                break;            case PANTS_CODE:                tvTittle.setText("选择裤子");                res = pants;                break;            case SHOES_CODE:                tvTittle.setText("选择鞋子");                res = shoes;                break;        }        inDialog = new InDialog(this, new InDialog.ClickListener() {            @Override            public void onSure(int res, String url) {                Intent intent = new Intent();                //把返回数据存入Intent                //设置返回数据                if (!TextUtils.isEmpty(url)) {                    intent.putExtra(RESULT_CODE, url);                    setResult(RESULT_CAMAER, intent);                } else {                    intent.putExtra(RESULT_CODE, res);                    setResult(RESULT_CHOSE, intent);                }                finish();            }        });        rv = findViewById(R.id.rv);        //设置布局管理器        GridLayoutManager gridLayoutManager = new GridLayoutManager(this, 2);        gridLayoutManager.setSpanSizeLookup(new GridLayoutManager.SpanSizeLookup() {            @Override            public int getSpanSize(int position) {                return 1;            }        });        rv.setLayoutManager(gridLayoutManager);        //设置adapter        rvAdapter = new RvAdapter(this, res, new RvAdapter.RvClick() {            @Override            public void onClick(View v, int res) {                inDialog.show(res, "");            }        });        rv.setAdapter(rvAdapter);    }    private String FILE_PATH;    private void openCamera() {        Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE, null);        FILE_PATH = Environment.getExternalStorageDirectory() + File.separator + String.valueOf(System.currentTimeMillis()) + "camera" + ".png";        ContentValues contentValues = new ContentValues(1);        contentValues.put(MediaStore.Images.Media.DATA, FILE_PATH);        Uri uri = getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, contentValues);        intent.putExtra(MediaStore.EXTRA_OUTPUT, uri);        startActivityForResult(intent, 101);    }    private void sellectRes(int res) {        Intent intent = new Intent();        //把返回数据存入Intent        intent.putExtra(RESULT_CODE, res);        //设置返回数据        setResult(RESULT_CHOSE, intent);        finish();    }    @Override    protected void onActivityResult(int requestCode, int resultCode, Intent data) {        super.onActivityResult(requestCode, resultCode, data);        if (requestCode == 101) { // 如果返回数据            Log.e("fuck", "收到相机图片" + FILE_PATH);            inDialog.show(0, FILE_PATH);        }    }}